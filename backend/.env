# backend/.env
# --------------------------------------------------------
# [기존 설정 유지] Database & Prisma & Etc
# --------------------------------------------------------
DATABASE_URL="postgresql://postgres:pw@localhost:5432/itm?schema=public"

# Prisma 엔진 체크섬 검증 무시 설정
PRISMA_ENGINES_CHECKSUM_IGNORE_MISSING="1"

# 로컬에 저장한 엔진 파일의 경로 지정 (절대 경로 또는 상대 경로)
PRISMA_QUERY_ENGINE_LIBRARY="./prisma/engines/query_engine.dll.node"

# PDF Server URL
PDF_SERVER_BASE_URL=http://127.0.0.1:8080

# Next.js / Vercel 관련 설정 (Frontend에서 사용될 수 있음)
NEXT_PUBLIC_VERCEL_TOOLBAR=false


# --------------------------------------------------------
# [신규 추가] Backend Server Common
# --------------------------------------------------------
# NestJS 내부 구동 포트 (Nginx나 Vite Proxy가 이 포트로 연결됨)
PORT=3000

# CORS 설정 (보안상 운영 환경에서는 실제 도메인으로 변경 권장)
CORS_ORIGIN="*"


# --------------------------------------------------------
# [신규 추가] JWT (JSON Web Token) 설정
# --------------------------------------------------------
# 보안을 위해 임의의 긴 문자열로 변경하여 사용하세요.
JWT_SECRET="itm_dashboard_modern_secret_key_change_this"
JWT_EXPIRATION="8h"


# --------------------------------------------------------
# [신규 추가] SAML 2.0 (Active Directory) 설정
# C# 프로젝트의 appsettings.Development.json 내용을 반영
# --------------------------------------------------------
# 1. IdP(AD) 정보
# IdP 로그인 URL (C# IdP:SingleSignOnUrl 대응)
SAML_ENTRY_POINT="https://adfs/ls/"

# IdP 로그아웃 URL (C# IdP:SingleLogoutUrl 대응)
SAML_LOGOUT_URL="https://adfs/ls/"

# IdP 인증서 (C# IdP:SigningCert 대응)
# .cer 파일 내용을 열어 "-----BEGIN CERTIFICATE-----" 부터 끝까지 한 줄로 넣으세요.
SAML_IDP_CERT="MIID...YOUR_AD_IDP_CERT_CONTENT...=="


# 2. SP(우리 서버) 정보
# 서비스 식별자 (C# SP:EntityId 대응)
SAML_ISSUER="urn:itm.dashboard:web:dev"

# 서명 알고리즘 (C# SP:SignatureAlgorithm 대응 - rsa-sha256)
SAML_SIGNATURE_ALGORITHM="sha256"

# [중요] SP 서명용 개인키 (C# SP:SigningPfx 대응)
# .pfx 파일에서 추출한 개인키(PEM 형식)를 줄바꿈(\n)으로 연결하여 입력하세요.
SAML_SP_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\nMIIEv...YOUR_SP_PRIVATE_KEY_CONTENT...=\n-----END PRIVATE KEY-----"


# --------------------------------------------------------
# [환경별 URL 설정]
# 개발 환경(HTTPS 8082)과 운영 환경(HTTPS 8080) 전환
# --------------------------------------------------------

# 1. 개발 환경 (Development PC) - https://localhost:8082
# C# 프로젝트의 https://10.000.00.000:8082/saml/acs 에 대응하는 Node.js 개발 주소
SAML_CALLBACK_URL="https://localhost:8082/api/auth/callback"
FRONTEND_URL="https://localhost:8082/login"

# 2. 운영 환경 (Production Server) - https://10.0.0.1:8080
# 배포 시 위 개발 설정을 주석(#) 처리하고, 아래 설정의 주석을 해제하여 사용하세요.
# SAML_CALLBACK_URL="https://10.0.0.1:8080/api/auth/callback"
# FRONTEND_URL="https://10.0.0.1:8080/login"
